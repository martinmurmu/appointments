<style type="text/css">

  .tachado {
    text-decoration: line-through;
  }

</style>

<div class="row">
  <div class="col-lg-12">
    <div class="row">
      <div class="col-lg-6 col-sm-6">
        <%= link_to "Add Patient to Waitlist", new_manager_consumer_path, :class => "btn btn-default" %>
        <%= link_to "Broadcast Open Time Slot", new_manager_appointment_path, :class => "btn btn-default" %>
      </div>
      <% if (notice) %>
        <div class="col-lg-6 col-sm-6">        
          <div class="alert alert-success alert-fade-out fade in">
            <button data-dismiss="alert" class="close close-sm" type="button">
              <i class="fa fa-times"></i>
            </button>
            <%= notice %>
          </div>
        </div>
      <% end %>
    </div>
  </div>
  <br />
  <div class="col-lg-12">
    <section class="panel">
      <header class="panel-heading">
        Waitlisted Patients
      </header>
      <table class="table table-striped table-advance table-hover">
        <thead>
          <tr>
            <th>Phone</th>
            <th>Tags</th>
            <th></th>
            <th></th>
            <th></th>
          </tr>
        </thead>
        <tbody>
          <% @consumers.each do |consumer| %>
            <% if (consumer.enabled) %>
              <tr>
                <td><%= consumer.phone_number %></td>
                <!-- TODO: This can be expensive -->
                <td><%= consumer.tags.where(:manager_id => current_manager.rolable.id).first.tags %></td>
                <td></td>
                <td>
                  <%= link_to 'Remove from Waitlist', manager_consumer_path(consumer), 
                    method: :delete, data: { confirm: 'Are you sure?' } %>
                </td>
                <td><%= link_to 'Edit', edit_manager_consumer_path(consumer) %></td>
              </tr>
            <% else %>
              <tr class="tachado">
                <td><%= consumer.phone_number %></td>
                <!-- TODO: This can be expensive -->
                <td><%= consumer.tags.where(:manager_id => current_manager.rolable.id).first.tags %></td>
                <td>disabled</td>
                <td>
                  <%= link_to 'Undo', enable_manager_consumer_path(consumer), 
                    method: :put, data: { confirm: 'Are you sure?' } %>
                </td>
                <td></td>
              </tr>
            <% end %>
          <% end %>
        </tbody>
      </table>
    </section>
  </div>
</div>

<script language="javascript">
  $(window).load(function() {
    $(".alert-fade-out").delay(2000).fadeTo(2000, 0, 'linear', function() { $(".alert-fade-out").hide() });
  });
</script>